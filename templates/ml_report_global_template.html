<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ML Global Report</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

  <style>
    body { background: #f8f8f8; padding: 25px; }
    .card-kpi { 
      padding: 15px; 
      border-radius: 12px; 
      background: white; 
      box-shadow: 0 2px 8px rgba(0,0,0,0.1); 
      text-align: center;
    }
    .section-title {
      margin-top: 45px;
      margin-bottom: 20px;
      font-weight: 300;
    }
  </style>
</head>

<body>

<h1>ðŸ“Š Machine Learning â€“ Global Report</h1>
<p>Generated automatically from all ML experiments.</p>
<hr>

<!-- ============================================ -->
<!-- TABLEAU DES MÃ‰TRIQUES COMPARATIVES -->
<!-- ============================================ -->
<h2 class="section-title">Model Comparison</h2>

<table class="table table-striped table-hover">
  <thead class="table-dark">
    <tr>
      <th>Model</th>
      <th>AUC</th>
      <th>AUC PR</th>
      <th>Accuracy</th>
      <th>Recall</th>
      <th>Precision</th>
    </tr>
  </thead>
  <tbody>
    {% for exp in experiments %}
    <tr>
      <td><b>{{ exp.name }}</b></td>
      <td>{{ exp.metrics.auc }}</td>
      <td>{{ exp.metrics.prAuc }}</td>
      <td>{{ exp.metrics.accuracy }}</td>
      <td>{{ exp.metrics.recall }}</td>
      <td>{{ exp.metrics.precision }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<hr>

<!-- ============================================ -->
<!-- COURBES ROC & PR COMPARÃ‰ES -->
<!-- ============================================ -->

<h2 class="section-title">ROC & PR Curves</h2>

<div class="row">
  <div class="col-md-6">
    <h4>ROC Curve</h4>
    <div id="roc_all"></div>
  </div>

  <div class="col-md-6">
    <h4>PR Curve</h4>
    <div id="pr_all"></div>
  </div>
</div>

<script>
var roc_traces = [];
var pr_traces = [];

{% for exp in experiments %}
roc_traces.push({
  x: {{ exp.roc_x }},
  y: {{ exp.roc_y }},
  mode: "lines",
  name: "{{ exp.name }}"
});
pr_traces.push({
  x: {{ exp.pr_x }},
  y: {{ exp.pr_y }},
  mode: "lines",
  name: "{{ exp.name }}"
});
{% endfor %}

Plotly.newPlot("roc_all", roc_traces, {title: "ROC Multi-model Comparison"});
Plotly.newPlot("pr_all", pr_traces, {title: "PR Multi-model Comparison"});
</script>

<hr>

<!-- ============================================ -->
<!-- FEATURE IMPORTANCES PAR MODÃˆLE -->
<!-- ============================================ -->

<h2 class="section-title">Feature Importances</h2>

{% for exp in experiments %}
<h3>{{ exp.name }}</h3>
<div id="fi_{{ loop.index }}"></div>
<script>
Plotly.newPlot("fi_{{ loop.index }}", [{
  x: {{ exp.fi_values }},
  y: {{ exp.fi_names }},
  type: "bar",
  orientation: "h"
}], {
  title: "Feature Importances â€“ {{ exp.name }}",
  margin: {l: 150}
});
</script>

<br>
{% endfor %}

</body>
</html>